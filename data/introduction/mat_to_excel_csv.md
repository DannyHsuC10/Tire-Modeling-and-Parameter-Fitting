# 批次轉換 `.mat` 檔案為 Excel 與 CSV
檔案位置>>[link](../data/mat_to_csv_excel.m)
## 功能概述
這份 MATLAB 腳本的主要目的，是 **自動化批次處理資料夾中的 `.mat` 檔案**，並將其中的變數轉換成 **Excel (`.xlsx`) 與 CSV (`.csv`) 格式**，以便後續資料分析與處理。

---

## 程式流程

1. **初始化與路徑設定**
   - 取得腳本所在資料夾路徑。
   - 定義輸入資料夾 `mat`，輸出資料夾 `csv` 與 `excel`。
   - 若輸出資料夾不存在，則自動建立。

2. **讀取 `.mat` 檔案**
   - 使用 `dir` 搜尋 `mat` 資料夾中的所有 `.mat` 檔案。
   - 若未找到任何檔案，則拋出錯誤。

3. **主迴圈處理**
   - 逐一讀取每個 `.mat` 檔案。
   - 將檔案中的變數載入並轉換成 `table` 格式。
   - 嘗試合併所有變數成一個完整表格：
     - 若列數不一致，則跳過該變數。
     - 若欄位名稱重複，則自動生成唯一名稱。

4. **輸出結果**
   - 將合併後的表格輸出為：
     - `.csv` 檔案 → 存放於 `csv` 資料夾。
     - `.xlsx` 檔案 → 存放於 `excel` 資料夾。

5. **工具函式 `convertToTable`**
   - 將不同型態的變數轉換成 `table`：
     - `table` → 直接使用。
     - `numeric` → 轉換為欄位或向量。
     - `struct` → 使用 `struct2table`。
     - `cell` → 使用 `cell2table`。
     - 其他型態 → 拋出錯誤。

---

## 使用場景
- `.mat` 檔案通常用於儲存 MATLAB 計算結果或實驗數據，但不易在其他工具中直接使用。  
- 轉換成 `.csv` 或 `.xlsx` 格式後，可以方便地在 **Excel、Python、R** 等工具中進行後續分析。  
- 此腳本適合用於 **批次資料清理、跨平台資料共享、數據前處理**。

---

## 範例使用方式
1. 將所有 `.mat` 檔案放入 `mat` 資料夾。  
2. 按run執行此腳本。  
3. 在 `csv` 與 `excel` 資料夾中取得轉換後的檔案。  
